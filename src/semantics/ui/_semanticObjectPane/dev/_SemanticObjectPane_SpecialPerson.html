<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">

<title>_SemanticObjectPane Browser Tests - Person</title>

<!-- required: the default dijit theme: -->
<link rel="stylesheet" href="../../../../../dojo/resources/dojo.css" />
<link id="themeStyles" rel="stylesheet" href="../../../../../dijit/themes/claro/claro.css" />


<!-- SCRIPT -->
<script>
  var dojoConfig = {
    async: true,
    parseOnLoad: false,
    has: {
      "dojo-debug-messages": true,
      "mvc-bindings-log-api": true
    }
  };
</script>

<script src="../../../../../dojo/dojo.js"></script>

<script type="text/javascript">
  function cycle() {
    setTimeout(function() {
      person.set("name", "NEW NAME");
    }, 1000);
    setTimeout(function() {
      subject.set("presentationMode", subject.EDIT);
    }, 2000);
    setTimeout(function() {
      subject.set("presentationMode", subject.BUSY);
    }, 3000);
    setTimeout(function() {
      subject.set("presentationMode", subject.WILD);
    }, 4000);
    setTimeout(function() {
      subject.set("presentationMode", subject.ERROR);
    }, 5000);
    setTimeout(function() {
      subject.set("presentationMode", subject.VIEW);
    }, 6000);
  }
  require(["dojo/parser",
          "ppwcode/semantics/ui/test/mock/SpecialPerson",
          "dijit/registry",
          "ppwcode/semantics/ui/_semanticObjectPane/test/mock/SpecialPersonPane",
          "dojo/domReady!"],
    function(parser, SpecialPerson, registry) {

      var parsePromise = parser.parse();
      parsePromise.then(function() {
        var json = {"name":"Pete Peeters","street":"Avenue de rue 93","zip":"1040 CAA","city":"Cité de Beauté","tel":"0322 44 442 22","email":"jandockx@hhh.org"};

        function createSpecialPerson() {
          var person = new SpecialPerson();
          person.reload(json);
          person.watch(function(propertyName, oldValue, newValue) {
            console.log("changed: " + propertyName + " from " + oldValue + " to " + newValue);
          });
          return person;
        }

        window.subject = registry.byId("subject");
        window.person = createSpecialPerson();
        subject.set("target", person);
        window.cycle();
      });
    }
  );
</script>
</head>

<body class="claro">
<!-- Define an instance of the widget to test. -->
<div id="subject" data-dojo-type="ppwcode/semantics/ui/_semanticObjectPane/test/mock/SpecialPersonPane"></div>

<div style="position: absolute; bottom: 30px; min-width: 500px;">
    <span style="float: left;">
      <button onclick="subject.set('presentationMode', subject.EDIT)">EDIT</button>
      <button onclick="subject.set('presentationMode', subject.BUSY)">BUSY</button>
      <button onclick="subject.set('presentationMode', subject.WILD)">WILD</button>
      <button onclick="subject.set('presentationMode', subject.ERROR)">ERROR</button>
      <button onclick="subject.set('presentationMode', subject.VIEW)">VIEW</button>
    </span>
    <span style="float: right">
      <button onclick="subject.set('target', null)">Clear Target</button>
      <button onclick="subject.set('target', person)">Set Target</button>
    </span>
</div>
</body>

</html>
