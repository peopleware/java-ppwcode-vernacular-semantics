<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">

<title>_SemanticObjectPane Browser Tests - Person</title>

<!-- required: the default dijit theme: -->
<link rel="stylesheet" href="../../../../dojo/resources/dojo.css" />
<link id="themeStyles" rel="stylesheet" href="../../../../dijit/themes/claro/claro.css" />
<style>
  .dijitTextBoxReadOnly {
    border-color: white !important;
  }

  .boldLabel {
    font-size: 90%;
    font-weight: bold;
    margin-top: 4px;
  }

  .fixedLabel {
    width: 4.5em;
    display: inline-block;
    font-size: 90%;
    font-weight: bold;
    margin-top: 4px;
  }

  .fieldsetClass {
    border:2px groove threedface;
    padding: 10px;
  }
</style>


<!-- SCRIPT -->
<script>
  var dojoConfig = {
    async: true,
    parseOnLoad: false,
    has: {
      "dojo-debug-messages": true,
      "mvc-bindings-log-api": true
    }
  };
</script>

<script src="../../../../dojo/dojo.js"></script>

<script type="text/javascript">
require(["dojo/parser",
  "ppwcode/contracts/doh",
  "ppwcode/semantics/ui/test/mock/viewmodel/SpecialPerson",
  "dijit/registry",
  "ppwcode/semantics/ui/test/mock/presentation/SpecialPersonPane",
  "dojo/domReady!"],
  function(parser, doh, SpecialPerson, registry) {

    var parsePromise = parser.parse();
    parsePromise.then(function() {
      var json = {"name":"Pete Peeters","street":"Avenue de rue 93","zip":"1040 CAA","city":"Cité de Beauté","tel":"0322 44 442 22","email":"jandockx@hhh.org"};

      function createSpecialPerson() {
        var person = new SpecialPerson();
        person.reload(json);
        person.watch(function(propertyName, oldValue, newValue) {
          console.log("changed: " + propertyName + " from " + oldValue + " to " + newValue);
        });
        return person;
      }

      var subject = registry.byId("subject");

      doh.register("_Semantic Object Pane - SpecialPerson",[

        function testInitialState() {
          doh.invars(subject);
          doh.is(SpecialPerson, subject.getTargetType());
          doh.is(subject.VIEW, subject.get("presentationMode"));
          doh.is(null, subject.get("target"));
          doh.is(subject.NOTARGET, subject.get("stylePresentationMode"));
          doh.f(subject.isInEditMode());
          doh.invars(subject._personPane);
          doh.is(subject.VIEW, subject._personPane.get("presentationMode"));
          doh.is(null, subject._personPane.get("target"));
          doh.is(subject.NOTARGET, subject._personPane.get("stylePresentationMode"));
          doh.f(subject._personPane.isInEditMode());
        },

        {
          name: "set and remove target",
          setUp: function() {
            this.specialPerson = createSpecialPerson();
          },
          runTest: function() {
            subject.set("target", this.specialPerson);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.VIEW, subject.get("presentationMode"));
            doh.is(this.specialPerson, subject.get("target"));
            doh.is(subject.VIEW, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.VIEW, subject._personPane.get("presentationMode"));
            doh.is(this.specialPerson, subject._personPane.get("target"));
            doh.is(subject.VIEW, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
            subject.set("target", null);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.VIEW, subject.get("presentationMode"));
            doh.is(null, subject.get("target"));
            doh.is(subject.NOTARGET, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.VIEW, subject._personPane.get("presentationMode"));
            doh.is(null, subject._personPane.get("target"));
            doh.is(subject.NOTARGET, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
          }
        },

        {
          name: "change name on target",
          setUp: function() {
            this.specialPerson = createSpecialPerson();
            subject.set("target", this.specialPerson);
          },
          runTest: function() {
            this.specialPerson.set("name", "NEW NAME");
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.VIEW, subject.get("presentationMode"));
            doh.is(this.specialPerson, subject.get("target"));
            doh.is(subject.VIEW, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.VIEW, subject._personPane.get("presentationMode"));
            doh.is(this.specialPerson, subject._personPane.get("target"));
            doh.is(subject.VIEW, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
            doh.is(this.specialPerson.get("name"), subject._personPane.txtName.get("value"));
          },
          tearDown: function() {
            subject.set("target", null);
          }
        },

        {
          name: "change name on widget",
          setUp: function() {
            this.specialPerson = createSpecialPerson();
            subject.set("target", this.specialPerson);
          },
          runTest: function() {
            subject._personPane.txtName.set("value", "NEW NAME");
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.VIEW, subject.get("presentationMode"));
            doh.is(this.specialPerson, subject.get("target"));
            doh.is(subject.VIEW, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.VIEW, subject._personPane.get("presentationMode"));
            doh.is(this.specialPerson, subject._personPane.get("target"));
            doh.is(subject.VIEW, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
            doh.is(subject._personPane.txtName.get("value"), this.specialPerson.get("name"));
          },
          tearDown: function() {
            subject.set("target", null);
          }
        },

        {
          name: "edit mode with a target",
          setUp: function() {
            this.specialPerson = createSpecialPerson();
            subject.set("target", this.specialPerson);
            subject.set("presentationMode", subject.VIEW);
          },
          runTest: function() {
            subject.set("presentationMode", subject.EDIT);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.EDIT, subject.get("presentationMode"));
            doh.is(this.specialPerson, subject.get("target"));
            doh.is(subject.EDIT, subject.get("stylePresentationMode"));
            doh.t(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.EDIT, subject._personPane.get("presentationMode"));
            doh.is(this.specialPerson, subject._personPane.get("target"));
            doh.is(subject.EDIT, subject._personPane.get("stylePresentationMode"));
            doh.t(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        },

        {
          name: "busy mode with a target",
          setUp: function() {
            this.specialPerson = createSpecialPerson();
            subject.set("target", this.specialPerson);
            subject.set("presentationMode", subject.EDIT);
          },
          runTest: function() {
            subject.set("presentationMode", subject.BUSY);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.BUSY, subject.get("presentationMode"));
            doh.is(this.specialPerson, subject.get("target"));
            doh.is(subject.BUSY, subject.get("stylePresentationMode"));
            doh.t(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.BUSY, subject._personPane.get("presentationMode"));
            doh.is(this.specialPerson, subject._personPane.get("target"));
            doh.is(subject.BUSY, subject._personPane.get("stylePresentationMode"));
            doh.t(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        },

        {
          name: "wild mode with a target",
          setUp: function() {
            this.specialPerson = createSpecialPerson();
            subject.set("target", this.specialPerson);
            subject.set("presentationMode", subject.BUSY);
          },
          runTest: function() {
            subject.set("presentationMode", subject.WILD);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.WILD, subject.get("presentationMode"));
            doh.is(this.specialPerson, subject.get("target"));
            doh.is(subject.WILD, subject.get("stylePresentationMode"));
            doh.t(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.WILD, subject._personPane.get("presentationMode"));
            doh.is(this.specialPerson, subject._personPane.get("target"));
            doh.is(subject.WILD, subject._personPane.get("stylePresentationMode"));
            doh.t(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        },

        {
          name: "error mode with a target",
          setUp: function() {
            this.specialPerson = createSpecialPerson();
            subject.set("target", this.specialPerson);
            subject.set("presentationMode", subject.BUSY);
          },
          runTest: function() {
            subject.set("presentationMode", subject.ERROR);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.ERROR, subject.get("presentationMode"));
            doh.is(this.specialPerson, subject.get("target"));
            doh.is(subject.ERROR, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.ERROR, subject._personPane.get("presentationMode"));
            doh.is(this.specialPerson, subject._personPane.get("target"));
            doh.is(subject.ERROR, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        },

        {
          name: "edit mode without a target",
          setUp: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          },
          runTest: function() {
            subject.set("presentationMode", subject.EDIT);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.EDIT, subject.get("presentationMode"));
            doh.is(null, subject.get("target"));
            doh.is(subject.NOTARGET, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.EDIT, subject._personPane.get("presentationMode"));
            doh.is(null, subject._personPane.get("target"));
            doh.is(subject.NOTARGET, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        },

        {
          name: "busy mode without a target",
          setUp: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.EDIT);
          },
          runTest: function() {
            subject.set("presentationMode", subject.BUSY);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.BUSY, subject.get("presentationMode"));
            doh.is(null, subject.get("target"));
            doh.is(subject.NOTARGET, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.BUSY, subject._personPane.get("presentationMode"));
            doh.is(null, subject._personPane.get("target"));
            doh.is(subject.NOTARGET, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        },

        {
          name: "wild mode without a target",
          setUp: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.BUSY);
          },
          runTest: function() {
            subject.set("presentationMode", subject.WILD);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.WILD, subject.get("presentationMode"));
            doh.is(null, subject.get("target"));
            doh.is(subject.NOTARGET, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.WILD, subject._personPane.get("presentationMode"));
            doh.is(null, subject._personPane.get("target"));
            doh.is(subject.NOTARGET, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        },

        {
          name: "error mode without a target",
          setUp: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.BUSY);
          },
          runTest: function() {
            subject.set("presentationMode", subject.ERROR);
            doh.invars(subject);
            doh.is(SpecialPerson, subject.getTargetType());
            doh.is(subject.ERROR, subject.get("presentationMode"));
            doh.is(null, subject.get("target"));
            doh.is(subject.NOTARGET, subject.get("stylePresentationMode"));
            doh.f(subject.isInEditMode());
            doh.invars(subject._personPane);
            doh.is(subject.ERROR, subject._personPane.get("presentationMode"));
            doh.is(null, subject._personPane.get("target"));
            doh.is(subject.NOTARGET, subject._personPane.get("stylePresentationMode"));
            doh.f(subject._personPane.isInEditMode());
          },
          tearDown: function() {
            subject.set("target", null);
            subject.set("presentationMode", subject.VIEW);
          }
        }
      ]
      );
      doh.run();
    });
  });
</script>
</head>

<body class="claro">
<!-- Define an instance of the widget to test. -->
<div id="subject" data-dojo-type="ppwcode/semantics/ui/test/mock/presentation/SpecialPersonPane"></div>
</body>

</html>
